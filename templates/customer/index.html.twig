{% extends 'base.html.twig' %}
{% import "macros/widgets.html.twig" as widgets %}
{% import "macros/datatables.html.twig" as tables %}
{% import "macros/toolbar.html.twig" as toolbar %}
{% import "customer/actions.html.twig" as actions %}

{% set columns = {
    'id_document_type': {'class': 'hidden-xs hidden-sm', 'orderBy': false},
    'number': {'class': 'hidden-xs hidden-sm', 'orderBy': false},
    'name': {'class': 'hidden-xs hidden-sm', 'orderBy': false},
    'email': {'class': 'hidden-xs hidden-sm', 'orderBy': false},
    'phone': {'class': 'hidden-xs hidden-sm hidden', 'orderBy': false},
    'mobile': {'class': 'hidden-xs hidden-sm hidden', 'orderBy': false},
    'visible': {'class': 'text-center w-min', 'orderBy': false},
    'actions': {'class': 'actions alwaysVisible'},
} %}

{% set tableName = 'customer_admin' %}

{% block page_title %}
	{{ 'admin_customer.title'|trans }}
{% endblock %}
{% block page_search %}
	{{ toolbar.dropDownSearch(toolbarForm) }}
{% endblock %}
{% block page_actions %}
	{{ actions.customers('index') }}
{% endblock %}

{% block main_before %}
	{{ tables.data_table_column_modal(tableName, columns) }}
{% endblock %}

{% block main %}

	{% if entries.count == 0 %}
		{{ widgets.nothing_found('kimai.customerUpdate kimai.customerTeamUpdate') }}
	{% else %}
		{{ tables.datatable_header(tableName, columns, query, {'reload': 'kimai.customerUpdate kimai.customerTeamUpdate'}) }}

		{% for entry in entries %}
			<tr {% if is_granted('view', entry) %} class="modal-ajax-form open-edit" data-href="{{ path('admin_customer_edit', {'id': entry.id}) }}" {% endif %}>
				<td class="{{ tables.data_table_column_class(tableName, columns, 'id_document_type') }}">
					{% if entry.idDocumentType is not empty and entry.idDocumentType.name is not empty%}
						{{ entry.idDocumentType.name|nl2br }}
					{% endif %}
				</td>
				<td class="{{ tables.data_table_column_class(tableName, columns, 'number') }}">{{ entry.number }}</td>
				<td class="{{ tables.data_table_column_class(tableName, columns, 'name') }}">{{ widgets.label_color_dot('customer', true, entry.name, null, entry.color) }}</td>
				<td class="{{ tables.data_table_column_class(tableName, columns, 'email') }}">{{ entry.email }}</td>
				<td class="{{ tables.data_table_column_class(tableName, columns, 'phone') }}">{{ entry.phone }}</td>
				<td class="{{ tables.data_table_column_class(tableName, columns, 'mobile') }}">{{ entry.mobile }}</td>
				<td class="{{ tables.data_table_column_class(tableName, columns, 'visible') }}">{{ widgets.label_visible(entry.visible) }}</td>
				<td class="{{ tables.data_table_column_class(tableName, columns, 'actions') }}">{{ actions.customer(entry, 'index') }}</td>
			</tr>
		{% endfor %}

		{{ tables.data_table_footer(entries, 'admin_customer_paginated') }}
	{% endif %}

{% endblock %}